language: python

python:
  - "3.7"
install:
  - pip install -r requirements.txt
  - pip install -r requirements-dev.txt
  - pip install .
script:
  - pytest --cov-report=xml --cov=pygosolnp tests/

after_success:
  - codecov

deploy:
  - provider: pypi
    user: "__token__"
    password:
      secure: YtTqVZC2iqDQEhtNGXpaEWtLXff0MJhMm1+5XkGb0uPCpZVk5E1TKy3E45DMLreCbVaWkcxbDY9gx+gy/hJvJLwSgGM3JeqYwMA1czBePsvi/Lnj9WV/jkQLE20IjIrnEFArfD6XU+oXqvebWTvxmPTNj7nZ0h1oNiom0eu7aCfY1wQRuxX+Fob2DhBKt8A4CbFwrXaiW0cvAs5Lx+JVpx+NyUUpKhOJmapP2hKH832OENeB3LHwFguER/jsz9vg/6AoGZCxBICi/CPAG/v+EERPOySERo/sKP8AZkWhby2ryfq6Blhmkmg+jHIqSQ1OqRkotY4xdznHxmt1BokNmyharEjfhBdWu+TRgvt7EE+RGgaEMRupbg45dGzfvBHrvyfJPkb/KMXMFJ8kLt6yaVSsEXBAhs+DxIY/8giX5WjAZyuIJlxKSKFq72P0rx1v2ERjwehNgeALqKLGXbXKIuBTLD74sFdFHXHSIWCDyJo8tyET/MUPefyZcPu341WA9JbOe4xI/yQRRprcZRv7N/897j2C+68CMmUdRJTC1lx7LVHe2bGl9VmUt/wyS1LutWi4RrkYEl3DRWIH+JJn3dZltAOuG/d1jbdGpFrXKDX+ybSNcB7Zh7wkBHc4ulxz+8E/y8zJDyZjm3Exwa5UI2LxsdIMZOBfCTG1liwSSGk=
    server: https://test.pypi.org/legacy/
    skip_existing: true
    skip_cleanup: true
    on:
       branch: main
  - provider: pypi
    user: "__token__"
    password: $PYPI_TOKEN
    skip_existing: true
    skip_cleanup: true
    on:
      branch: release